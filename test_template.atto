(* Minimal test for recursive ADT type inference *)

type Template =
  TConst of float
| TVar of string
| TAdd of Template * Template

let testFn = fun tmpl ->
  case tmpl of
    Template.TConst r -> 1.0
  | Template.TVar v -> 2.0
  | Template.TAdd (a, b) -> 3.0
in testFn (Template.TConst 42.0)
